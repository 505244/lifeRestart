class u extends ui.view.CyberTheme.CelebrityUI{constructor(){super(),this.btnRetry.on(Laya.Event.CLICK,this,()=>this.random()),this.btnNext.on(Laya.Event.CLICK,this,this.next),this.panelCharacter.vScrollBar.elasticDistance=150}#e;static#t=Laya.plugin.extractComponents(u.uiView,["boxCharacter","boxTalent","boxUniqueUnGenerate"]);#a(a,t){const{name:n,property:s,talent:o}=a,e=u.#t("boxCharacter"),i=e.getChildByName("vboxStates"),r=e.getChildByName("boxName");r.getChildByName("label").text=n;const c=$_.clone(s);for(const l in c)Math.abs(c[l]-Math.PI)<1e-7&&(c[l]="Ï€");i.getChildByName("label").text=$_.format($lang.F_PropertyStr,c);for(const l of o){const h=u.#t("boxTalent");h.getChildByName("label").text=$_.format($lang.F_TalentSelection,l),h.y=i.height+i.space;let d=h.getChildByName(`grade${l.grade}`);d&&(d.visible=!0),i.addChild(h)}const C=new Laya.Box;return C.height=i.space,C.y=i.height,i.addChild(C),i.scaleY=0,e.dataSource=a,e.switch=l=>i.scaleY=l?1:0,e.click=(l,h)=>{r.offAll(Laya.Event.CLICK),r.on(Laya.Event.CLICK,h||this,l)},t&&e.click(t),e}#n(a){const t=u.#t("boxUniqueUnGenerate"),n=t.getChildByName("boxName"),s=t.getChildByName("vboxStates"),o=s.getChildByName("label"),i=s.getChildByName("boxBtn").getChildByName("btn");return o.event(Laya.Event.RESIZE),s.scaleY=0,t.dataSource=!1,t.switch=r=>s.scaleY=r?1:0,t.click=(r,c)=>{n.offAll(Laya.Event.CLICK),n.on(Laya.Event.CLICK,c||this,r)},t.generate=(r,c)=>{i.offAll(Laya.Event.CLICK),i.on(Laya.Event.CLICK,c||this,r)},a&&t.generate(a),t}init(){this.random()}close(){this.#e=null,this.vboxCharacter.destroyChildren(!0)}random(a){this.#e=null,this.vboxCharacter.destroyChildren(!0);let{unique:t,normal:n}=core.characterRandom();if(!a){for(;n.length<10;){const e=core.characterRandom();n=[...n,...e.normal]}n=n.slice(0,10)}const s=[],o=this.generateUnique(t,()=>{core.generateUnique(),this.random(n)});o&&s.push(o),(a||n).forEach(e=>s.push(this.#a(e))),s.forEach((e,i)=>{e.y=i,this.vboxCharacter.addChild(e),e.click(()=>{this.#e&&this.#e.switch(!1),this.#e=e,e.switch(!0),e.event(Laya.Event.RESIZE)})}),a&&o&&(this.#e=o,o.switch(!0),o.event(Laya.Event.RESIZE))}generateUnique(a,t){return a?a.generate?(a.name=$lang.UI_UniqueWaTaShi,this.#a(a)):this.#n(t):null}next(){if(!this.#e)return $$event("message",["M_PleaseSelectOne"]);if(!this.#e.dataSource)return $$event("message",["M_UnGenerate"]);const{property:a,talent:t}=this.#e.dataSource,n=core.remake(t.map(s=>s.id));n.length>0&&$$event("message",[n.map(s=>["F_TalentReplace",s])]),$ui.switchView(UI.pages.TRAJECTORY,{propertyAllocate:a,talents:t,enableExtend:!1})}}export{u as default};
